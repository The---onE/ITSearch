<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>IT搜索</title>
    <link rel="Icon" href="Content/favicon.ico">
    <!--Jquery文件-->
    <script src="Content/js/jquery/jquery.min.js"></script>
    <!--EasyUI js文件-->
    <script src="Content/js/jquery-easyui-1.4.4/jquery.easyui.min.js"></script>
    <script src="Content/js/jquery-easyui-1.4.4/jquery.easyui.plus.js"></script>
    <script src="Content/js/jquery-easyui-1.4.4/locale/easyui-lang-zh-CN.js"></script>
    <!--EasyUI 样式-->
    <link href="Content/css/jquery-easyui-1.4.4/base/easyui.css" rel="stylesheet" />
    <link href="Content/css/jquery-easyui-1.4.4/skin-purple.css" rel="stylesheet" />
    <!--自定义的图标样式-->
    <link href="Content/css/fontawesome/css/font-awesome.min.css" rel="stylesheet" />

    <script>
        var history = [];
        var count = 0;
        var index = -1;
        history[-1] = '';

        datas = [
            //必应
            {
                id: 'bing',
                title: 'Bing',
                url: 'http://www.bing.com/',
                search: 'http://cn.bing.com/search?q='
            },
            //CSDN
            {
                id: 'csdn',
                title: 'CSDN',
                url: 'http://www.csdn.net/',
                search: 'http://so.csdn.net/so/search/s.do?q='
            },
            //CSDN下载
            {
                id: 'csdn_download',
                title: 'CSDN下载',
                url: 'http://download.csdn.net/',
                search: 'http://download.csdn.net/search?q='
            },
            //36氪
            {
                id: '36rr',
                title: '36Kr',
                url: 'http://36kr.com/',
                search: 'http://36kr.com/search/articles/'
            },
            //博客园
            {
                id: 'cnblogs',
                title: '博客园',
                url: 'http://www.cnblogs.com/',
                search: 'http://zzk.cnblogs.com/s?t=b&w='
            },
        ]

        $(function () {
            $.each(datas, function (key, value) {
                $('#tt').tabs('add', {
                    title: value.title,
                    content: '<iframe id="' + value.id + '" frameborder="0" src="' + value.url + '" scrolling="auto" style="width: 100%; height: 100%; overflow: hidden; margin: auto"></iframe>',
                    closable: false,
                });
            })
            $('#tt').tabs('select', 0);
        })

        function prev() {
            if (count > 0) {
                index = index > -1 ? index - 1 : -1;
                searchInFrame(history[index]);
            }
        }

        function next() {
            if (count > 0) {
                index = index < count - 1 ? index + 1 : count - 1;
                searchInFrame(history[index]);
            }
        }

        function openWebsite(value, name) {
            var url = value
            var re = /^https?:\/\/.+$/i
            if (value.search(re) == -1) {
                url = "http://" + value;
            }

            $('#tt').tabs('add', {
                title: value,
                content: '<iframe frameborder="0" src=' + url + ' scrolling="auto" style="width:100%; height:100%; overflow:hidden; margin:auto"></iframe>',
                closable: true,
            });
        }

        function searchWebsite(value, name) {
            index++;
            count = index + 1;
            history[index] = value;
            searchInFrame(value);
        }

        function searchInFrame(value) {
            if (index != -1 && value != '') {
                $('#search').searchbox({
                    value: value
                });
                $.each(datas, function (k, v) {
                    $('#' + v.id).attr('src', v.search + value);
                })
            } else {
                $('#search').searchbox({
                    value: ''
                });
                $.each(datas, function (k, v) {
                    $('#' + v.id).attr('src', v.url);
                })
            }

            if (index <= -1) {
                $('#prev').linkbutton({
                    disabled: true
                });
            } else {
                $('#prev').linkbutton({
                    disabled: false
                });
            }

            if (index >= count - 1) {
                $('#next').linkbutton({
                    disabled: true
                });
            } else {
                $('#next').linkbutton({
                    disabled: false
                });
            }
        }
    </script>
</head>
<body class="easyui-layout">
    <!-- 顶部面板 -->
    <div data-options="region:'north', split:false" style="height: 30px;">
        <input id="website" class="easyui-searchbox" style="height: 28px; width: 500px"
            data-options="searcher:openWebsite, prompt:'打开新网页'" />
        <input id="search" class="easyui-searchbox" style="height: 28px; width: 500px"
            data-options="searcher:searchWebsite, prompt:'请输入要搜索的内容'" />
        <a id="prev" class="easyui-linkbutton" data-options="disabled:true, text:'←', onClick:prev"></a>
        <a id="next" class="easyui-linkbutton" data-options="disabled:true, text:'→', onClick:next"></a>
    </div>
    <!-- 右侧面板 -->
    <div data-options="region:'east',title:'记事板',split:true, collapsed:true" style="width: 200px;">
        <textarea style="width: 100%; height: 100%;"></textarea>
    </div>
    <!-- 主面板 -->
    <div data-options="region:'center'" style="padding: 0px;">
        <div id="tt" class="easyui-tabs" style="width: 100%; height: 99%;">
        </div>
    </div>
</body>
</html>
